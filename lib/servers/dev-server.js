"use strict";const e=require("path"),r=require("fs");require("http-proxy-middleware");const t=require("webpack"),{getWebpackConfig:o}=require("../utils/webpackConfig"),n=o("development"),i=require("express");require("connect-history-api-fallback");const c=i(),a=(t=>{let o={...t},n=o.entry,i={};if("object"!=typeof n)throw new Error('entry必须object类型\n 例如："entry": {"main":"./src/pages/index.js"}\r\n');for(let t in n){if(Array.isArray(n[t]))throw new Error('entry必须object类型\n 例如："entry": {"main":"./src/pages/index.js"}\r\n');try{const o=String(r.readFileSync(e.resolve(n[t])));/\bmodule.hot\b/.test(o)||(console.log("\n系统检测到入口文件缺少热更新必须的module.hot，系统已为您自动添加\n"),r.appendFileSync(e.resolve(n[t]),";if (module.hot) {module.hot.accept()}; "))}catch(e){throw`入口文件加载失败，请检查入口文件\r\n${e}`}i[t]=[n[t],"webpack-hot-middleware/client?reload=false&path=/__webpack_hmr&timeout=20000"]}return o.entry=i,o})(n),l=t(a),s=require("webpack-dev-middleware")(l);require("webpack-hot-middleware")(l),module.exports=e=>{console.log(),console.log("A-------",1),c.use(s)};
