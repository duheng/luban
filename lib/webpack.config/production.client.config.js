"use strict";const e=require("webpack"),s=require("webpack-merge"),n=require("path"),r=require("mini-css-extract-plugin"),t=require("./base.config"),o=require("../plugins/creat-version-plugin"),u=require("../plugins/creat-html-plugin"),{config:i,getTemplate:c}=require("../utils/common");let l=t(i);const a=process.cwd(),p=n.resolve(a,i.build),m="js/[name]@[contenthash:8].js",d="css/[name]@[contenthash:8].css";l.module.rules.map((e=>{/css|sass|less/.test(e.use)&&(e.use.shift(),e.use={loader:r.loader,options:{hmr:!0}})}));const h=()=>{let s=[new r({filename:d,chunkFilename:d,ignoreOrder:!0}),new e.HashedModuleIdsPlugin,...u("production",l,c)];return i.chunkver&&s.push(new o(i)),s};module.exports=()=>{const e=i.devtool||{};return s(l,{output:{path:p,publicPath:i.static[process.env.NODE_ENV],chunkFilename:m,filename:m},mode:"production",devtool:e.production||"none",plugins:h(),performance:{hints:!1}})};
